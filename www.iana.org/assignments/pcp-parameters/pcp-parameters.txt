                                                        Port Control Protocol (PCP) Parameters

   Created
           2012-11-21

   Last Updated
           2016-02-05

   Available Formats
           [IMG]
           XML [IMG]
           HTML [IMG]
           Plain text

   Registries included below

     * PCP Opcodes
     * PCP Result Codes
     * PCP Options

PCP Opcodes

   Expert(s)

 Dan Wing, Stuart Cheshire

   Reference
           [RFC6887]

   Available Formats
           [IMG]
           CSV

     Range   Registration Procedures
   0-31, 127 Standards Action
     32-63   Specification Required

   Value        Description        Reference
   0      ANNOUNCE                 [RFC6887]
   1      MAP                      [RFC6887]
   2      PEER                     [RFC6887]
   3      AUTHENTICATION           [RFC7652]
   4-63   Unassigned
   64-95  Reserved                 [RFC6887]
   96-126 Reserved for Private Use [RFC6887]
   127    Reserved                 [RFC6887]

PCP Result Codes

   Expert(s)

 Dan Wing, Stuart Cheshire

   Reference
           [RFC6887]

   Available Formats
           [IMG]
           CSV

     Range    Registration Procedures
   0-127, 255 Standards Action
    128-191   Specification Required

    Value            Name                                                        Description                                              Reference
   0       SUCCESS                   Success.                                                                                             [RFC6887]
   1       UNSUPP_VERSION            The version number at the start of the PCP Request header is not recognized by this PCP server. This [RFC6887]
                                     is a long lifetime error. [RFC6887] describes PCP version 2.
   2       NOT_AUTHORIZED            The requested operation is disabled for this PCP client, or the PCP client requested an operation    [RFC6887]
                                     that cannot be fulfilled by the PCP server's security policy. This is a long lifetime error.
   3       MALFORMED_REQUEST         The request could not be successfully parsed. This is a long lifetime error.                         [RFC6887]
   4       UNSUPP_OPCODE             Unsupported Opcode. This is a long lifetime error.                                                   [RFC6887]
   5       UNSUPP_OPTION             Unsupported Option. This error only occurs if the Option is in the mandatory-to-process range. This  [RFC6887]
                                     is a long lifetime error.
   6       MALFORMED_OPTION          Malformed Option (e.g., appears too many times, invalid length). This is a long lifetime error.      [RFC6887]
   7       NETWORK_FAILURE           The PCP server or the device it controls are experiencing a network failure of some sort (e.g., has  [RFC6887]
                                     not obtained an External IP address). This is a short lifetime error.
                                     Request is well-formed and valid, but the server has insufficient resources to complete the
                                     requested operation at this time. For example, the NAT device cannot create more mappings at this
   8       NO_RESOURCES              time, is short of CPU cycles or memory, or is unable to handle the request due to some other         [RFC6887]
                                     temporary condition. The same request may succeed in the future. This is a system-wide error,
                                     different from USER_EX_QUOTA. This can be used as a catch- all error, should no other error message
                                     be suitable. This is a short lifetime error.
   9       UNSUPP_PROTOCOL           Unsupported transport protocol, e.g. SCTP in a NAT that handles only UDP and TCP. This is a long     [RFC6887]
                                     lifetime error.
   10      USER_EX_QUOTA             This attempt to create a new mapping would exceed this subscriber's port quota. This is a short      [RFC6887]
                                     lifetime error.
                                     The suggested external port and/or external address cannot be provided. This error MUST only be
                                     returned for: * MAP requests that included the PREFER_FAILURE Option (normal MAP requests will
   11      CANNOT_PROVIDE_EXTERNAL   return an available external port); * MAP requests for the SCTP protocol (PREFER_FAILURE is          [RFC6887]
                                     implied); * PEER requests. See Section 13.2 of [RFC6887] for processing details. The error lifetime
                                     depends on the reason for the failure.
                                     The source IP address of the request packet does not match the contents of the PCP Client's IP
   12      ADDRESS_MISMATCH          Address field, due to an unexpected NAT on the path between the PCP client and the PCP-controlled    [RFC6887]
                                     NAT or firewall. This is a long lifetime error.
                                     The PCP server was not able to create the filters in this request. This result code MUST only be
   13      EXCESSIVE_REMOTE_PEERS    returned if the MAP request contained the FILTER Option. See Section 13.3 for processing             [RFC6887]
                                     information. This is a long lifetime error.
   14      INITIATION                The client includes this PCP result code in its request to the server for authentication.            [RFC7652]
   15      AUTHENTICATION_REQUIRED   This error response is sent to the client if EAP authentication is required.                         [RFC7652]
   16      AUTHENTICATION_FAILED     This error response is sent to the client if EAP authentication failed.                              [RFC7652]
   17      AUTHENTICATION_SUCCEEDED  This success response is sent to the client if EAP authentication succeeded.                         [RFC7652]
   18      AUTHORIZATION_FAILED      This error response is sent to the client if EAP authentication succeeded but authorization failed.  [RFC7652]
   19      SESSION_TERMINATED        This PCP result code indicates to the partner that the PA session must be terminated.                [RFC7652]
   20      UNKNOWN_SESSION_ID        This error response is sent from the PCP server if there is no known PA session associated with the  [RFC7652]
                                     Session ID sent in the PA request or common PCP request from the PCP client.
   21      DOWNGRADE_ATTACK_DETECTED This PCP result code indicates to the client that the server detected a downgrade attack.            [RFC7652]
   22      AUTHENTICATION_REQUEST    The server indicates to the client that the PA message contains an EAP request.                      [RFC7652]
   23      AUTHENTICATION_REPLY      The client indicates to the server that the PA message contains an EAP response.                     [RFC7652]
   24-191  Unassigned
   192-254 Reserved for Private Use                                                                                                       [RFC6887]
   255     Reserved                                                                                                                       [RFC6887]

PCP Options

   Expert(s)

 Dan Wing, Stuart Cheshire

   Reference
           [RFC6887]

   Note

 Values 0-127 are mandatory to process, and 128-255 are optional to process.

   Available Formats
           [IMG]
           CSV

         Range        Registration Procedures
   0-63, 127-191, 255 Standards Action
     64-95, 192-223   Specification Required

    Value            Name                   Purpose          Valid for Opcodes  Length   May Appear in      Maximum              Reference
                                                                                                          Occurrences
   0       Reserved                                                                                                     [RFC6887]
                                                                                         Request. May
                                    Indicates the MAP or                                 appear in
                                    PEER request is for a                                response only
   1       THIRD_PARTY              host other than the host MAP, PEER         16 octets if it appeared 1               [RFC6887]
                                    sending the PCP Option.                              in the
                                                                                         associated
                                                                                         request.
                                    Indicates that the PCP                               Request. May
                                    server should not create                             appear in
                                    an alternative mapping                               response only
   2       PREFER_FAILURE           if the suggested         MAP               0         if it appeared 1               [RFC6887]
                                    external port and                                    in the
                                    address cannot be                                    associated
                                    mapped.                                              request.
                                                                                         Request. May
                                                                                         appear in      As many as fit
                                    Specifies a filter for                               response only  within maximum
   3       FILTER                   incoming packets.        MAP               20 octets if it appeared PCP message     [RFC6887]
                                                                                         in the         size.
                                                                                         associated
                                                                                         request.
   4       NONCE                    See Section 5.3 of       AUTHENTICATION    4 octets  Request and    1               [RFC7652]
                                    [RFC7652].                                           response.
   5       AUTHENTICATION_TAG       See Section 5.4 of       MAP, PEER,        variable  Request and    1               [RFC7652]
                                    [RFC7652].               ANNOUNCE                    response.
   6       PA_AUTHENTICATION_TAG    See Section 5.5 of       AUTHENTICATION    variable  Request and    1               [RFC7652]
                                    [RFC7652].                                           response.
   7       EAP_PAYLOAD              See Section 5.6 of       AUTHENTICATION    variable  Request and    1               [RFC7652]
                                    [RFC7652].                                           response.
                                                                                                        As many as fit
   8       PRF                      See Section 5.7 of       AUTHENTICATION    4 octets  Request and    within maximum  [RFC7652]
                                    [RFC7652].                                           response.      PCP message
                                                                                                        size.
                                                                                                        As many as fit
   9       MAC_ALGORITHM            See Section 5.8 of       AUTHENTICATION    4 octets  Request and    within maximum  [RFC7652]
                                    [RFC7652].                                           response.      PCP message
                                                                                                        size.
   10      SESSION_LIFETIME         See Section 5.9 of       AUTHENTICATION    4 octets  Response.      1               [RFC7652]
                                    [RFC7652].
   11      RECEIVED_PAK             See Section 5.10 of      AUTHENTICATION    4 octets  Request and    1               [RFC7652]
                                    [RFC7652].                                           response.
   12      ID_INDICATOR             See Section 5.11 of      AUTHENTICATION    variable  Response.      1               [RFC7652]
                                    [RFC7652].
   13-95   Unassigned
   96-126  Reserved for Private Use                                                                                     [RFC6887]
   127     Reserved                                                                                                     [RFC6887]
                                                                                         Request. May
                                                                               variable, appear in
                                    Used to associate a text                   maximum   response only
   128     DESCRIPTION              description with a       MAP, PEER         1016      if it appeared 1               [RFC7220]
                                    mapping.                                   octets.   in the
                                                                                         associated
                                                                                         request.
                                    Learn the prefix used by                                            1 for a
                                    the NAT64 to build                                                  request. As
                                    IPv4-converted IPv6                                                 many as fit
   129     PREFIX64                 addresses. This is used  MAP, ANNOUNCE     variable  request,       within the      [RFC7225]
                                    by a host for local                                  response       maximum PCP
                                    address synthesis (e.g.,                                            message size
                                    when an IPv4 address is                                             for a response.
                                    present in referrals).
   130     PORT_SET                 To map sets of ports.    MAP               5 bytes   Request and    1               [RFC7753]
                                                                                         response.
   131-191 Unassigned
                                    Indicate if an entry                                 Request and
   192     CHECKPOINT_REQUIRED      needs to be              MAP, PEER         0         response.      1               [RFC-vinapamula-flow-ha-14]
                                    check-pointed.
   193-223 Unassigned
   224-254 Reserved for Private Use                                                                                     [RFC6887]
   255     Reserved                                                                                                     [RFC6887]
